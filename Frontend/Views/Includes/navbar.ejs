<nav class="navbar">
        <div class="nav-container">
                <!-- Logo -->
                <div class="logo">
                        <a href="/">
                                <img src="/Resources/images/Beyond Man Logo (Circle).png" alt="Beyond Man Logo">
                        </a>
                </div>
                <ul class="desktop-menu">
                        <li><a href="/#browse-articles" class="nav-link">Explore</a></li>


                        <li class="dropdown">
                                <a href="#" class="nav-link">Courses <i
                                                class="fas fa-chevron-down dropdown-icon"></i></a>
                                <div class="dropdown-content">
                                        <div class="dropdown-grid" id="courses-container">
                                                <!-- This will be populated dynamically -->
                                                <div class="no-courses-message"
                                                        style="display: none; padding: 20px; text-align: center;">
                                                        <i class="fas fa-book-open"
                                                                style="font-size: 2rem; margin-bottom: 10px; color: #3f37c9;"></i>
                                                        <h4>Exciting Courses Coming Soon!</h4>
                                                        <p>We're preparing some amazing content for you. Stay tuned!</p>

                                                </div>
                                        </div>
                                </div>
                        </li>

                        <li><a href="/about" class="nav-link">About </a></li>
                        <li><a href="/contact" class="nav-link">Contact</a></li>
                </ul>

                <div class="search-container">
                        <form action="/search/" method="get" class="search-form">
                                <div class="search-box">
                                        <input class="search-input" type="text" name="search"
                                                placeholder="Search here..." autocomplete="off">
                                        <button type="submit" class="search-button">
                                                <i class="fas fa-search"></i>
                                        </button>
                                </div>
                        </form>
                </div>


                <!-- Desktop Navigation -->
                <div class="nav-main">
                        <div class="nav-actions">


                                <% if (!user) { %>
                                        <div class="user-menu">
                                                <div class="user-avatar">
                                                        <i class="fas fa-user-circle"></i>
                                                </div>
                                                <div class="user-dropdown">
                                                        <div class="auth-buttons">
                                                                <a href="/login" class="btn btn-login">Login</a>
                                                                <a href="/register" class="btn btn-primary"
                                                                        style="color: white;">Register</a>
                                                        </div>
                                                </div>
                                        </div>

                                        <% } else { %>
                                                <div class="user-menu">
                                                        <div class="user-avatar">
                                                                <i class="fas fa-user-circle"></i>
                                                        </div>
                                                        <div class="user-dropdown">
                                                                <!-- <a href="/profile"><i class="fas fa-user"></i> My
                                                                        Profile</a> -->
                                                                <!-- <a href="/dashboard"><i
                                                                                class="fas fa-tachometer-alt"></i>
                                                                        Dashboard</a>
                                                                <a href="/settings"><i class="fas fa-cog"></i>
                                                                        Settings</a> -->
                                                                <div class="divider"></div>
                                                                <a onclick="showLogOutCard()" class="logout-btn"><i
                                                                                class="fas fa-power-off"></i> Log
                                                                        Out</a>
                                                        </div>
                                                </div>
                                                <% } %>


                        </div>
                </div>

                <!-- Mobile Menu Toggle -->
                <button class="hamburger" aria-label="Menu" aria-expanded="false">
                        <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                        </span>
                </button>
        </div>

        <!-- Mobile Menu -->
        <div class="mobile-menu">
                <div class="mobile-menu-header">
                        <% if (!user) { %>
                                <div class="mobile-auth">
                                        <a href="/login" class="btn btn-login">Login</a>
                                        <a href="/register" class="btn btn-primary">Register</a>
                                </div>
                                <% } else { %>
                                        <div class="mobile-user">
                                                <i class="fas fa-user-circle"></i>
                                                <span>Welcome back!</span>
                                        </div>
                                        <% } %>
                </div>

                <div class="mobile-search">

                        <form action="/search/" method="get" class="search-form">
                                <div class="search-box">
                                        <input class="search-input" type="text" name="search"
                                                placeholder="Search here..." autocomplete="off">
                                        <button type="submit" class="search-button">
                                                <i class="fas fa-search"></i>
                                        </button>
                                </div>
                        </form>
                </div>


                <ul class="mobile-nav">
                        <li><a href="/#browse-articles" class="nav-link">Explore</a></li>

                        <li class="mobile-dropdown">
                                <div class="mobile-dropdown-toggle">
                                        <span><i class="fas fa-book-open"></i> Courses</span>
                                        <i class="fas fa-chevron-down"></i>
                                </div>
                                <ul class="mobile-dropdown-content" id="mobile-courses-container">
                                        <!-- Loading spinner -->
                                        <li class="loading-courses">
                                                <i class="fas fa-spinner fa-spin"></i> Loading courses...
                                        </li>

                                        <!-- Fallback for no courses -->
                                        <li class="no-courses-message" style="display: none;">
                                                <a href="#">
                                                        <i class="fas fa-book"></i> New courses coming soon!
                                                </a>
                                        </li>
                                </ul>
                        </li>

                        <li><a href="/about"><i class="fas fa-info-circle"></i> About Us</a></li>
                        <li><a href="/contact"><i class="fas fa-envelope"></i> Contact</a></li>

                        <% if (user) { %>
                                <li class="mobile-user-links">
                                        <a href="/profile"><i class="fas fa-user"></i> Profile</a>
                                        <a href="/dashboard"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
                                        <a onclick="showLogOutCard()" class="mobile-logout"><i
                                                        class="fas fa-power-off"></i> Log
                                                Out</a>
                                </li>

                                <% } %>


                </ul>
        </div>
        <!-- Logout Confirmation Modal -->
        <div id="logoutModal" class="logout-modal">
                <div class="logout-modal-content">
                        <div class="logout-modal-header">
                                <i class="fas fa-sign-out-alt"></i>
                                <h3>Log Out</h3>
                        </div>
                        <div class="logout-modal-body">
                                <p>Are you sure you want to log out of Beyond Man?</p>
                        </div>
                        <div class="logout-modal-footer">
                                <button id="cancelButton" class="logout-modal-btn cancel-btn">Cancel</button>
                                <button id="logoutButton" class="logout-modal-btn logout-btn">Log Out</button>
                        </div>
                </div>
        </div>

        <!-- Overlay -->
        <div id="overlay" class="logout-overlay"></div>
</nav>

<!-- Overlay for mobile menu -->
<div class="mobile-overlay"></div>

<script>
        document.addEventListener('DOMContentLoaded', function () {

                // Function to load courses (reusable for both desktop and mobile)
                // Modified loadCourses function
                function loadCourses(containerId, isMobile = false) {
                        const container = document.getElementById(containerId);
                        const noCoursesMsg = container.querySelector('.no-courses-message');
                        const loadingElement = isMobile ? container.querySelector('.loading-courses') : null;

                        // For desktop version, get the parent dropdown-grid element
                        const dropdownGrid = !isMobile ? container : null;

                        fetch('/nav-courses')
                                .then(response => {
                                        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                                        return response.json();
                                })
                                .then(courses => {
                                        if (isMobile && loadingElement) loadingElement.remove();

                                        if (courses && courses.length > 0) {
                                                container.innerHTML = '';

                                                // For desktop, add dropdown-grid class if courses exist
                                                if (dropdownGrid) {
                                                        dropdownGrid.classList.add('dropdown-grid');
                                                }

                                                courses.forEach(course => {
                                                        if (isMobile) {
                                                                // Mobile version - list items
                                                                const listItem = document.createElement('li');
                                                                listItem.innerHTML = `
                            <a href="${course.slug ? '/course/' + course.slug : '#'}">
                                <i class="${course.icon || 'fas fa-book'}"></i> ${course.title}
                            </a>
                        `;
                                                                container.appendChild(listItem);
                                                        } else {
                                                                // Desktop version - cards
                                                                const courseCard = document.createElement('a');
                                                                courseCard.href = course.slug ? `/course/${course.slug}` : '#';
                                                                courseCard.className = 'course-card';
                                                                courseCard.innerHTML = `
                            <i class="${course.icon || 'fas fa-book'} course-icon"></i>
                            <h4>${course.title}</h4>
                            <p>${course.description}</p>
                        `;
                                                                container.appendChild(courseCard);
                                                        }
                                                });
                                        } else {
                                                // For desktop, remove dropdown-grid class if no courses
                                                if (dropdownGrid) {
                                                        dropdownGrid.classList.remove('dropdown-grid');
                                                }
                                                noCoursesMsg.style.display = 'block';
                                                if (isMobile && loadingElement) loadingElement.remove();
                                        }
                                })
                                .catch(error => {
                                        console.error('Error fetching courses:', error);
                                        // For desktop, remove dropdown-grid class on error
                                        if (dropdownGrid) {
                                                dropdownGrid.classList.remove('dropdown-grid');
                                        }
                                        noCoursesMsg.style.display = 'block';
                                        noCoursesMsg.querySelector('h4').textContent = 'Oops! Something went wrong';
                                        noCoursesMsg.querySelector('p').textContent = error.message;
                                        if (isMobile && loadingElement) loadingElement.remove();
                                });
                }

                // Load courses for both desktop and mobile
                loadCourses('courses-container'); // Desktop
                loadCourses('mobile-courses-container', true); // Mobile

                function courseNotification() {
                        console.log("Course Notification")
                }

                // Mobile menu toggle - keep your existing code
                const hamburger = document.querySelector('.hamburger');
                const mobileMenu = document.querySelector('.mobile-menu');
                const mobileOverlay = document.querySelector('.mobile-overlay');

                function toggleMenu() {
                        hamburger.classList.toggle('active');
                        mobileMenu.classList.toggle('active');
                        mobileOverlay.classList.toggle('active');

                        // Optional: Reload mobile courses when menu opens
                        if (mobileMenu.classList.contains('active')) {
                                loadCourses('mobile-courses-container', true);
                        }
                }

                function closeMenu() {
                        hamburger.classList.remove('active');
                        mobileMenu.classList.remove('active');
                        mobileOverlay.classList.remove('active');
                }

                hamburger.addEventListener('click', toggleMenu);
                mobileOverlay.addEventListener('click', closeMenu);

                // Close menu when clicking anywhere outside
                document.addEventListener('click', function (e) {
                        if (!mobileMenu.contains(e.target) &&
                                !hamburger.contains(e.target) &&
                                mobileMenu.classList.contains('active')) {
                                closeMenu();
                        }
                });

                // Mobile dropdown toggle
                const mobileDropdownToggles = document.querySelectorAll('.mobile-dropdown-toggle');
                mobileDropdownToggles.forEach(toggle => {
                        toggle.addEventListener('click', function () {
                                const dropdown = this.parentElement;
                                dropdown.classList.toggle('active');

                                // Rotate chevron icon
                                const icon = this.querySelector('.fa-chevron-down');
                                if (icon) {
                                        icon.classList.toggle('fa-chevron-down');
                                        icon.classList.toggle('fa-chevron-up');
                                }
                        });
                });
                // Improved Dropdown Handling
                const dropdowns = document.querySelectorAll('.dropdown');
                const userMenu = document.querySelector('.user-menu');
                const userDropdown = document.querySelector('.user-dropdown');

                // Show dropdown on hover
                dropdowns.forEach(dropdown => {
                        dropdown.addEventListener('mouseenter', function () {
                                this.querySelector('.dropdown-content').style.opacity = '1';
                                this.querySelector('.dropdown-content').style.visibility = 'visible';
                                this.querySelector('.dropdown-content').style.transform = 'translateY(0)';
                        });

                        dropdown.addEventListener('mouseleave', function () {
                                this.querySelector('.dropdown-content').style.opacity = '0';
                                this.querySelector('.dropdown-content').style.visibility = 'hidden';
                                this.querySelector('.dropdown-content').style.transform = 'translateY(10px)';
                        });
                });

                // User menu dropdown
                if (userMenu) {
                        userMenu.addEventListener('mouseenter', function () {
                                userDropdown.style.opacity = '1';
                                userDropdown.style.visibility = 'visible';
                                userDropdown.style.transform = 'translateY(0)';
                        });

                        userMenu.addEventListener('mouseleave', function () {
                                userDropdown.style.opacity = '0';
                                userDropdown.style.visibility = 'hidden';
                                userDropdown.style.transform = 'translateY(10px)';
                        });
                }

                // Close dropdowns when clicking outside (only for mobile)
                document.addEventListener('click', function (e) {
                        if (window.innerWidth <= 768) {
                                if (!e.target.closest('.dropdown')) {
                                        document.querySelectorAll('.dropdown-content').forEach(dropdown => {
                                                dropdown.style.opacity = '0';
                                                dropdown.style.visibility = 'hidden';
                                                dropdown.style.transform = 'translateY(10px)';
                                        });
                                }

                                if (!e.target.closest('.user-menu')) {
                                        userDropdown.style.opacity = '0';
                                        userDropdown.style.visibility = 'hidden';
                                        userDropdown.style.transform = 'translateY(10px)';
                                }
                        }
                });
        });
</script>